
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.5/shaka-player.compiled.js"></script>
    <style>body,html{margin:0;padding:0;width:100%;height:100%;background:#000;overflow:hidden;}video{width:100%;height:100%;}</style>
</head>
<body>
    <video id="v" controls autoplay playsinline></video>
    <script>
        async function init() {
            const video = document.getElementById('v');
            const player = new shaka.Player(video);
            const p = new URLSearchParams(window.location.search);
            const ch = p.get('ch');

            const canales = {
                "laliga": { 
                    u: "https://uhdlaliga-dash-movistarplus.emisiondof6.com/manifestuhd.mpd", 
                    k: {'39d712255fe54f41b6b9587d45e3c5a8': '3471f707aad517e2aa718dd04e416e07'} 
                },
                "la1": { 
                    u: "https://tvela1-dash-movistarplus.emisiondof6.com/manifest.mpd", 
                    k: {'14fc0e3b249a43faa52fc69279e77cab': '71c987df089eda046faf592931e84a5c'} 
                },
                "accion": {
                    u: "https://m-accion-dash-movistarplus.emisiondof6.com/manifest.mpd",
                    k: {'f09071060965413391746283737f2863': '9590675271a2578505545a9686566415'}
                }
            };

            if (canales[ch]) {
                // Configurar el User-Agent que pide tu lista
                player.getNetworkingEngine().registerRequestFilter((type, request) => {
                    request.headers['User-Agent'] = 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.43 Safari/537.36';
                });

                player.configure({ drm: { clearKeys: canales[ch].k } });
                try { await player.load(canales[ch].u); } catch (e) { console.error("Error", e); }
            }
        }
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
